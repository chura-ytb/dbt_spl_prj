with name_change as (
	select
		SEASON,
		PERIOD as BATTLE_PERIOD,
		GAME_VER,
		LOBBY,
		MODE as BATTLE_MODE,
		STAGE as BATTLE_STAGE,
		TIME as BATTLE_TIME,
		WIN,
		KNOCKOUT,
		RANK as BATTLE_RANK,
		POWER,
		ALPHA_INKED,
		ALPHA_INK_PERCENT,
		ALPHA_COUNT,
		ALPHA_COLOR,
		ALPHA_THEME,
		BRAVO_INKED,
		BRAVO_INK_PERCENT,
		BRAVO_COUNT,
		BRAVO_COLOR,
		BRAVO_THEME,
		A1_WEAPON,
		A1_KILL_ASSIST,
		A1_KILL,
		A1_ASSIST,
		A1_DEATH,
		A1_SPECIAL,
		A1_INKED,
		A1_ABILITIES,
		A2_WEAPON,
		A2_KILL_ASSIST,
		A2_KILL,
		A2_ASSIST,
		A2_DEATH,
		A2_SPECIAL,
		A2_INKED,
		A2_ABILITIES,
		A3_WEAPON,
		A3_KILL_ASSIST,
		A3_KILL,
		A3_ASSIST,
		A3_DEATH,
		A3_SPECIAL,
		A3_INKED,
		A3_ABILITIES,
		A4_WEAPON,
		A4_KILL_ASSIST,
		A4_KILL,
		A4_ASSIST,
		A4_DEATH,
		A4_SPECIAL,
		A4_INKED,
		A4_ABILITIES,
		B1_WEAPON,
		B1_KILL_ASSIST,
		B1_KILL,
		B1_ASSIST,
		B1_DEATH,
		B1_SPECIAL,
		B1_INKED,
		B1_ABILITIES,
		B2_WEAPON,
		B2_KILL_ASSIST,
		B2_KILL,
		B2_ASSIST,
		B2_DEATH,
		B2_SPECIAL,
		B2_INKED,
		B2_ABILITIES,
		B3_WEAPON,
		B3_KILL_ASSIST,
		B3_KILL,
		B3_ASSIST,
		B3_DEATH,
		B3_SPECIAL,
		B3_INKED,
		B3_ABILITIES,
		B4_WEAPON,
		B4_KILL_ASSIST,
		B4_KILL,
		B4_ASSIST,
		B4_DEATH,
		B4_SPECIAL,
		B4_INKED,
		B4_ABILITIES,
		MEDAL1_GRADE,
		MEDAL1_NAME,
		MEDAL2_GRADE,
		MEDAL2_NAME,
		MEDAL3_GRADE,
		MEDAL3_NAME,
		EVENT as EVENT_NAME
	from  {{source('spl_raw', 'raw_battle_results')}}
),
final as (
select
	SEASON,
	cast(BATTLE_PERIOD as timestamp_tz) as BATTLE_PERIOD,
	GAME_VER,
	LOBBY,
	BATTLE_MODE,
	BATTLE_STAGE,
	cast(BATTLE_TIME as number(10, 0)) as BATTLE_TIME,
	WIN,
	cast(KNOCKOUT as boolean) as KNOCKOUT,
	BATTLE_RANK,
	cast(POWER as number(10, 1)) as POWER,
	cast(ALPHA_INKED as number(10, 0)) as ALPHA_INKED,
	cast(ALPHA_INK_PERCENT as number(3, 1)) as ALPHA_INK_PERCENT,
	cast(ALPHA_COUNT as number(10, 0)) as ALPHA_COUNT,
	ALPHA_COLOR,
	ALPHA_THEME,
	cast(BRAVO_INKED as number(10, 0)) as BRAVO_INKED,
	cast(BRAVO_INK_PERCENT as number(3, 1)) as BRAVO_INK_PERCENT,
	cast(BRAVO_COUNT as number(10, 0)) as BRAVO_COUNT,
	BRAVO_COLOR,
	BRAVO_THEME,
	A1_WEAPON,
	cast(A1_KILL_ASSIST as number(3, 0)) as A1_KILL_ASSIST,
	cast(A1_KILL as number(3, 0)) as A1_KILL,
	cast(A1_ASSIST as number(3, 0)) as A1_ASSIST,
	cast(A1_DEATH as number(3, 0)) as A1_DEATH,
	cast(A1_SPECIAL as number(3, 0)) as A1_SPECIAL,
	cast(A1_INKED as number(4, 0)) as A1_INKED,
	A1_ABILITIES,
	A2_WEAPON,
	cast(A2_KILL_ASSIST as number(3, 0)) as A2_KILL_ASSIST,
	cast(A2_KILL as number(3, 0)) as A2_KILL,
	cast(A2_ASSIST as number(3, 0)) as A2_ASSIST,
	cast(A2_DEATH as number(3, 0)) as A2_DEATH,
	cast(A2_SPECIAL as number(3, 0)) as A2_SPECIAL,
	cast(A2_INKED as number(4, 0)) as A2_INKED,
	A2_ABILITIES,
	A3_WEAPON,
	cast(A3_KILL_ASSIST as number(3, 0)) as A3_KILL_ASSIST,
	cast(A3_KILL as number(3, 0)) as A3_KILL,
	cast(A3_ASSIST as number(3, 0)) as A3_ASSIST,
	cast(A3_DEATH as number(3, 0)) as A3_DEATH,
	cast(A3_SPECIAL as number(3, 0)) as A3_SPECIAL,
	cast(A3_INKED as number(4, 0)) as A3_INKED,
	A3_ABILITIES,
	A4_WEAPON,
	cast(A4_KILL_ASSIST as number(3, 0)) as A4_KILL_ASSIST,
	cast(A4_KILL as number(3, 0)) as A4_KILL,
	cast(A4_ASSIST as number(3, 0)) as A4_ASSIST,
	cast(A4_DEATH as number(3, 0)) as A4_DEATH,
	cast(A4_SPECIAL as number(3, 0)) as A4_SPECIAL,
	cast(A4_INKED as number(4, 0)) as A4_INKED,
	A4_ABILITIES,
	B1_WEAPON,
	cast(B1_KILL_ASSIST as number(3, 0)) as B1_KILL_ASSIST,
	cast(B1_KILL as number(3, 0)) as B1_KILL,
	cast(B1_ASSIST as number(3, 0)) as B1_ASSIST,
	cast(B1_DEATH as number(3, 0)) as B1_DEATH,
	cast(B1_SPECIAL as number(3, 0)) as B1_SPECIAL,
	cast(B1_INKED as number(4, 0)) as B1_INKED,
	B1_ABILITIES,
	B2_WEAPON,
	cast(B2_KILL_ASSIST as number(3, 0)) as B2_KILL_ASSIST,
	cast(B2_KILL as number(3, 0)) as B2_KILL,
	cast(B2_ASSIST as number(3, 0)) as B2_ASSIST,
	cast(B2_DEATH as number(3, 0)) as B2_DEATH,
	cast(B2_SPECIAL as number(3, 0)) as B2_SPECIAL,
	cast(B2_INKED as number(4, 0)) as B2_INKED,
	B2_ABILITIES,
	B3_WEAPON,
	cast(B3_KILL_ASSIST as number(3, 0)) as B3_KILL_ASSIST,
	cast(B3_KILL as number(3, 0)) as B3_KILL,
	cast(B3_ASSIST as number(3, 0)) as B3_ASSIST,
	cast(B3_DEATH as number(3, 0)) as B3_DEATH,
	cast(B3_SPECIAL as number(3, 0)) as B3_SPECIAL,
	cast(B3_INKED as number(4, 0)) as B3_INKED,
	B3_ABILITIES,
	B4_WEAPON,
	cast(B4_KILL_ASSIST as number(3, 0)) as B4_KILL_ASSIST,
	cast(B4_KILL as number(3, 0)) as B4_KILL,
	cast(B4_ASSIST as number(3, 0)) as B4_ASSIST,
	cast(B4_DEATH as number(3, 0)) as B4_DEATH,
	cast(B4_SPECIAL as number(3, 0)) as B4_SPECIAL,
	cast(B4_INKED as number(4, 0)) as B4_INKED,
	B4_ABILITIES,
	MEDAL1_GRADE,
	MEDAL1_NAME,
	MEDAL2_GRADE,
	MEDAL2_NAME,
	MEDAL3_GRADE,
	MEDAL3_NAME,
	EVENT_NAME
from name_change
)
select *
from final

