with name_change as (
    select
        season,
        period as battle_period,
        game_ver,
        lobby,
        mode as battle_mode,
        stage as battle_stage,
        time as battle_time,
        win,
        knockout,
        rank as battle_rank,
        power,
        alpha_inked,
        alpha_ink_percent,
        alpha_count,
        alpha_color,
        alpha_theme,
        bravo_inked,
        bravo_ink_percent,
        bravo_count,
        bravo_color,
        bravo_theme,
        a1_weapon,
        a1_kill_assist,
        a1_kill,
        a1_assist,
        a1_death,
        a1_special,
        a1_inked,
        a1_abilities,
        a2_weapon,
        a2_kill_assist,
        a2_kill,
        a2_assist,
        a2_death,
        a2_special,
        a2_inked,
        a2_abilities,
        a3_weapon,
        a3_kill_assist,
        a3_kill,
        a3_assist,
        a3_death,
        a3_special,
        a3_inked,
        a3_abilities,
        a4_weapon,
        a4_kill_assist,
        a4_kill,
        a4_assist,
        a4_death,
        a4_special,
        a4_inked,
        a4_abilities,
        b1_weapon,
        b1_kill_assist,
        b1_kill,
        b1_assist,
        b1_death,
        b1_special,
        b1_inked,
        b1_abilities,
        b2_weapon,
        b2_kill_assist,
        b2_kill,
        b2_assist,
        b2_death,
        b2_special,
        b2_inked,
        b2_abilities,
        b3_weapon,
        b3_kill_assist,
        b3_kill,
        b3_assist,
        b3_death,
        b3_special,
        b3_inked,
        b3_abilities,
        b4_weapon,
        b4_kill_assist,
        b4_kill,
        b4_assist,
        b4_death,
        b4_special,
        b4_inked,
        b4_abilities,
        medal1_grade,
        medal1_name,
        medal2_grade,
        medal2_name,
        medal3_grade,
        medal3_name,
        event as event_name
    from {{ source('spl_raw', 'raw_battle_results') }}
),

final as (
    select
        season,
        cast(battle_period as timestamp_tz) as battle_period,
        game_ver,
        lobby,
        battle_mode,
        battle_stage,
        cast(battle_time as number(10, 0)) as battle_time,
        win,
        cast(knockout as boolean) as knockout,
        battle_rank,
        cast(power as number(10, 1)) as power,
        cast(alpha_inked as number(10, 0)) as alpha_inked,
        cast(alpha_ink_percent as number(3, 1)) as alpha_ink_percent,
        cast(alpha_count as number(10, 0)) as alpha_count,
        alpha_color,
        alpha_theme,
        cast(bravo_inked as number(10, 0)) as bravo_inked,
        cast(bravo_ink_percent as number(3, 1)) as bravo_ink_percent,
        cast(bravo_count as number(10, 0)) as bravo_count,
        bravo_color,
        bravo_theme,
        a1_weapon,
        cast(a1_kill_assist as number(3, 0)) as a1_kill_assist,
        cast(a1_kill as number(3, 0)) as a1_kill,
        cast(a1_assist as number(3, 0)) as a1_assist,
        cast(a1_death as number(3, 0)) as a1_death,
        cast(a1_special as number(3, 0)) as a1_special,
        cast(a1_inked as number(4, 0)) as a1_inked,
        a1_abilities,
        a2_weapon,
        cast(a2_kill_assist as number(3, 0)) as a2_kill_assist,
        cast(a2_kill as number(3, 0)) as a2_kill,
        cast(a2_assist as number(3, 0)) as a2_assist,
        cast(a2_death as number(3, 0)) as a2_death,
        cast(a2_special as number(3, 0)) as a2_special,
        cast(a2_inked as number(4, 0)) as a2_inked,
        a2_abilities,
        a3_weapon,
        cast(a3_kill_assist as number(3, 0)) as a3_kill_assist,
        cast(a3_kill as number(3, 0)) as a3_kill,
        cast(a3_assist as number(3, 0)) as a3_assist,
        cast(a3_death as number(3, 0)) as a3_death,
        cast(a3_special as number(3, 0)) as a3_special,
        cast(a3_inked as number(4, 0)) as a3_inked,
        a3_abilities,
        a4_weapon,
        cast(a4_kill_assist as number(3, 0)) as a4_kill_assist,
        cast(a4_kill as number(3, 0)) as a4_kill,
        cast(a4_assist as number(3, 0)) as a4_assist,
        cast(a4_death as number(3, 0)) as a4_death,
        cast(a4_special as number(3, 0)) as a4_special,
        cast(a4_inked as number(4, 0)) as a4_inked,
        a4_abilities,
        b1_weapon,
        cast(b1_kill_assist as number(3, 0)) as b1_kill_assist,
        cast(b1_kill as number(3, 0)) as b1_kill,
        cast(b1_assist as number(3, 0)) as b1_assist,
        cast(b1_death as number(3, 0)) as b1_death,
        cast(b1_special as number(3, 0)) as b1_special,
        cast(b1_inked as number(4, 0)) as b1_inked,
        b1_abilities,
        b2_weapon,
        cast(b2_kill_assist as number(3, 0)) as b2_kill_assist,
        cast(b2_kill as number(3, 0)) as b2_kill,
        cast(b2_assist as number(3, 0)) as b2_assist,
        cast(b2_death as number(3, 0)) as b2_death,
        cast(b2_special as number(3, 0)) as b2_special,
        cast(b2_inked as number(4, 0)) as b2_inked,
        b2_abilities,
        b3_weapon,
        cast(b3_kill_assist as number(3, 0)) as b3_kill_assist,
        cast(b3_kill as number(3, 0)) as b3_kill,
        cast(b3_assist as number(3, 0)) as b3_assist,
        cast(b3_death as number(3, 0)) as b3_death,
        cast(b3_special as number(3, 0)) as b3_special,
        cast(b3_inked as number(4, 0)) as b3_inked,
        b3_abilities,
        b4_weapon,
        cast(b4_kill_assist as number(3, 0)) as b4_kill_assist,
        cast(b4_kill as number(3, 0)) as b4_kill,
        cast(b4_assist as number(3, 0)) as b4_assist,
        cast(b4_death as number(3, 0)) as b4_death,
        cast(b4_special as number(3, 0)) as b4_special,
        cast(b4_inked as number(4, 0)) as b4_inked,
        b4_abilities,
        medal1_grade,
        medal1_name,
        medal2_grade,
        medal2_name,
        medal3_grade,
        medal3_name,
        event_name
    from name_change
)

select *
from final
